!function(){angular.module("groupExpenserClientApp",["ngResource","http-auth-interceptor","ngCookies","ui"]),-1!==window.location.hostname.indexOf("group-expenser.dev")?angular.module("groupExpenserClientApp").constant("domain","http://group-expenser.dev"):angular.module("groupExpenserClientApp").constant("domain","http://aqueous-tundra-9580.herokuapp.com"),angular.module("groupExpenserClientApp").config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/log_in.html",controller:"LogInCtrl"}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl"}).when("/trips/new",{templateUrl:"views/trips/form.html",controller:"TripFormCtrl"}).when("/trips/:id",{templateUrl:"views/trips/show.html",controller:"TripCtrl",resolve:{trip:["TripLoader",function(a){return a()}],expenses:["ExpensesLoader",function(a){return a()}]}}).when("/trips/:id/edit",{templateUrl:"views/trips/form.html",controller:"TripFormCtrl"}).when("/users/:id",{templateUrl:"views/logging_in.html",controller:"LoggingInCtrl"}).when("/trips/:tripId/expenses/new",{templateUrl:"views/expenses/form.html",controller:"ExpenseFormCtrl"}).when("/trips/:tripId/expenses/:id/edit",{templateUrl:"views/expenses/form.html",controller:"ExpenseFormCtrl"}).when("/trips/:tripId/expenses/:id",{templateUrl:"views/expenses/expense.html",controller:"ExpenseCtrl"}).when("/trips/:tripId/expenses/:expenseId/obligations/:id/edit",{templateUrl:"views/obligations/form.html",controller:"ObligationFormCtrl"}).when("/trips/:tripId/expenses/:expenseId/contributions/new",{templateUrl:"views/contributions/form.html",controller:"ContributionFormCtrl"}).when("/trips/:tripId/expenses/:expenseId/contributions/:id/edit",{templateUrl:"views/contributions/form.html",controller:"ContributionFormCtrl"}).when("/trips/:tripId/members",{templateUrl:"views/members/members.html",controller:"MembersCtrl"}).when("/trips/:tripId/members/invite",{templateUrl:"views/members/invite.html",controller:"InviteCtrl"}).when("/trips/:tripId/members/:id",{templateUrl:"views/members/member.html",controller:"MemberCtrl"}).when("/trips/:tripId/members/:id/edit",{templateUrl:"views/members/form.html",controller:"MemberFormCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","$routeParams","$currentUser","$navigationStack","authService","domain",function(a,b,c,d,e,f,g){return a.currentUser=d.get(),a.navigationStack=e,a.domain=g,a.setTitle=function(b){return a.title=b},a.hasTitle=function(){return a.title&&""!==a.title},a.setImage=function(b){return a.image=b},a.hasImage=function(){return a.image&&""!==a.image},a.setLeftButtonText=function(b){return a.leftButtonText=b},a.hasLeftButton=function(){return a.leftButtonText&&""!==a.leftButtonText},a.setRightButton=function(b,c){return a.rightButtonText=b,a.rightButtonLink=c},a.hasRightButton=function(){return a.rightButtonText&&""!==a.rightButtonText},a.isMine=function(b,c){return c||(c="user_id"),a.currentUser.id===b[c]},a.isOrganizer=function(b){return a.currentUser.id===b.organizer_id},a.$on("event:auth-loginRequired",function(){return console.log("Login required")}),a.$on("event:auth-loginConfirmed",function(c,e){return d.set(e),a.currentUser=e,b.path("/profile")}),a.$on("$routeChangeStart",function(){return a.title=null,a.image=null,a.leftButtonText=null,a.leftButtonLink=null,a.rightButtonText=null,a.rightButtonLink=null,-1!==b.path().indexOf("users")?a.currentUserId=b.path().split("/users/")[1]:void 0})}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("Contribution",["$resource","domain",function(a,b){var c;return c=a(""+b+"/expenses/:expense_id/contributions/:id",{expense_id:"@expense_id",id:"@id"},{query:{method:"GET",isArray:!0},show:{method:"GET"},create:{method:"POST"},destroy:{method:"DELETE"},update:{method:"PUT"}})}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("Expense",["$resource","domain",function(a,b){var c;return c=a(""+b+"/trips/:tripId/expenses/:id",{tripId:"@trip_id",id:"@id"},{query:{method:"GET",isArray:!0},show:{method:"GET"},create:{method:"POST"},destroy:{method:"DELETE"},update:{method:"PUT"}})}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("Member",["$resource","domain",function(a,b){var c;return c=a(""+b+"/trips/:tripId/members/:id",{tripId:"@tripId",id:"@id"})}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("Obligation",["$resource","domain",function(a,b){var c;return c=a(""+b+"/expenses/:expenseId/obligations/:id",{expenseId:"@expense_id",id:"@id"},{query:{method:"GET",isArray:!0},show:{method:"GET"},create:{method:"POST"},destroy:{method:"DELETE"},update:{method:"PUT"}})}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("Trip",["$resource","$http","domain",function(a,b,c){var d;return d=a(""+c+"/trips/:id",{id:"@id"},{query:{method:"GET",isArray:!0},show:{method:"GET"},create:{method:"POST"},destroy:{method:"DELETE"},update:{method:"PUT"}}),d.prototype.removeMember=function(a){return b["delete"](""+c+"/trips/"+this.id+"/memberships/"+a.id)},d}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("User",["$resource","$http","domain",function(a,b,c){var d;return d=a(""+c+"/users/:id",{id:"@id"},{update:{method:"PUT"}}),d.prototype.$login=function(){return b.post(""+c+"/users/login",this)},d}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("$currentUser",["$cookieStore","$http",function(a,b){var c;return c={user:null},c.get=function(){return a.get("User")&&c.set(a.get("User")),c.user},c.set=function(d){return c.user=d,a.put("User",d),b.defaults.headers.common.user=d.id},c}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("$navigationStack",["$rootScope","$location","$cookieStore",function(a,b,c){var d,e;return d=function(){function a(a){this.max=a,this.stack=c.get("navigationStack")||[]}return a.prototype.add=function(a){return this.stack[this.stack.length-1]!==a?(this.stack.push(a),c.put("navigationStack",this.stack.slice(0,+(this.stack.length-1)+1||9e9))):void 0},a.prototype.pop=function(){return this.stack.splice(this.stack.length-1,1),c.put("navigationStack",this.stack.slice(0,+(this.stack.length-1)+1||9e9))},a.prototype.current=function(){return this.stack[this.stack.length-2]},a.prototype.empty=function(){return this.stack.length<=1},a}(),e=new d,a.$on("$routeChangeStart",function(){return e.current()!==b.path()?e.add(b.path()):e.pop()}),e}])}.call(this),function(){angular.module("groupExpenserClientApp").filter("normCurrency",function(){return function(a){return a.indexOf(!0)?a.replace("$",'<span class="currency">$</span>'):a}})}.call(this),function(){angular.module("groupExpenserClientApp").directive("normBackButton",["$parse","$navigationStack",function(a,b){return{restrict:"E",templateUrl:"/views/shared/back-button.html",link:function(a){return a.navigationStack=b}}}])}.call(this),function(){angular.module("groupExpenserClientApp").factory("ExpensesLoader",["Expense","$route","$q",function(a,b,c){return function(){var d;return d=c.defer(),a.query({tripId:b.current.params.id},function(a){return d.resolve(a)}),d.promise}}]).factory("TripLoader",["Trip","$route","$q",function(a,b,c){return function(){var d;return d=c.defer(),a.get({id:b.current.params.id},function(a){return a.image_url="/images/blue-mountain.jpg",d.resolve(a)}),d.promise}}]).controller("TripCtrl",["$scope","$routeParams","trip","expenses","$location",function(a,b,c,d){return a.trip=c,a.expenses=d}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("ProfileCtrl",["$scope","Trip",function(a,b){return a.trips=b.query()}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("LogInCtrl",["$scope","User","authService",function(a,b,c){return a.user=new b({email:"rsnorman15@gmail.com",password:"test"}),a.submit=function(){return a.user.$login().success(function(a){return c.loginConfirmed(a)})}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("LoggingInCtrl",["$scope","$routeParams","authService","User",function(a,b,c,d){return a.user=d.get({id:b.id},function(a){return c.loginConfirmed(a)})}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("ContributionFormCtrl",["$scope","$location","$routeParams","Expense","Contribution",function(a,b,c,d,e){return a.expense=d.get({tripId:c.tripId,id:c.expenseId}),a.contribution=c.id?e.get({expense_id:c.expenseId,id:c.id}):new e({expense_id:c.expenseId,amount:0}),a.save=function(){return a.contribution.$save(function(){return b.path("/trips/"+a.expense.trip_id+"/expenses/"+a.expense.id)})},a["delete"]=function(){return confirm("Are you sure you want to delete this contribution?")?a.contribution.$delete(function(){return b.path("/trips/"+a.expense.trip_id+"/expenses/"+a.expense.id)}):void 0}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("ObligationFormCtrl",["$scope","$location","$routeParams","Expense","Obligation",function(a,b,c,d,e){return a.expense=d.get({tripId:c.tripId,id:c.expenseId}),a.obligation=e.get({expenseId:c.expenseId,id:c.id}),a.update=function(){return a.obligation.$update(function(){return b.path("/trips/"+a.expense.trip_id+"/expenses/"+a.expense.id)})},a["delete"]=function(){return confirm("Are you sure you want to delete this obligation?")?(a.obligation.amount=0,a.obligation.$update(function(){return b.path("/trips/"+a.expense.trip_id+"/expenses/"+a.expense.id)})):void 0}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("TripFormCtrl",["$scope","$location","$routeParams","Trip",function(a,b,c,d){return c.id?(a.trip=d.get({id:c.id}),a.action="Update"):(a.trip=new d({organizer_id:a.currentUser.id}),a.action="Create"),a.setTitle(""+a.action+" Trip"),a.create=function(){return"Create"===a.action?a.trip.$save(function(a){return b.path("/trips/"+a.id)}):a.trip.$update(function(){return b.path("/trips/"+a.trip.id)})},a["delete"]=function(){return confirm("Are you sure you want to delete this trip?")?(a.trip.$destroy(),b.path("/profile")):void 0}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("ExpenseCtrl",["$scope","$routeParams","Expense",function(a,b,c){return a.expense=c.get({tripId:b.tripId,id:b.id},function(){return a.setTitle(a.expense.name),a.isMine(a.expense,"purchaser_id")?a.setRightButton("Edit","#/trips/"+a.expense.trip_id+"/expenses/"+a.expense.id+"/edit"):void 0}),a.hasTip=function(){return a.expense&&a.tip&&0!==a.tip},a.hasObligations=function(){return a.expense&&a.expense.obligations&&0!==a.expense.obligations.length},a.hasContributions=function(){return a.expense&&a.expense.contributions&&0!==a.expense.contributions.length},a.canEditObligation=function(b){return a.expense.purchaser_id===a.currentUser.id||b.user_id===a.currentUser.id},a.canAddContribution=function(){var b,c,d,e;if(!a.expense.obligations)return!1;if(a.expense.contributions.length===a.expense.obligations.length)return!1;if(a.expense.purchaser_id===a.currentUser.id)return!0;for(e=a.expense.contributions,c=0,d=e.length;d>c;c++)if(b=e[c],b.user_id===a.currentUser.id)return!1;return!0}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("ExpenseFormCtrl",["$scope","$location","$routeParams","Expense",function(a,b,c,d){return c.id?(a.expense=d.get({tripId:c.tripId,id:c.id},function(){return 1*a.expense.cost,1*a.expense.tip,a.addTipVisible=a.hasTip()}),a.action="Update"):(a.expense=new d({trip_id:c.tripId}),a.action="Create"),a.setTitle(""+a.action+" Expense"),a.addTipVisible=!1,a.hasTip=function(){return a.expense.tip&&0!==a.expense.tip},a.create=function(){return"Create"===a.action?a.expense.$save(function(){return b.path("/trips/"+a.expense.trip_id)}):a.expense.$update(function(){return b.path("/trips/"+a.expense.trip_id+"/expenses/"+a.expense.id)})},a.addTip=function(){return a.addTipVisible=!0,a.expense.tip=.15*a.expense.cost},a.removeTip=function(){return a.addTipVisible=!1,a.expense.tip=0},a["delete"]=function(){return confirm("Are you sure you want to delete this expense?")?(a.expense.$destroy(),b.path("/trips/"+a.expense.trip_id)):void 0}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("ExpensesCtrl",["$scope","$routeParams","Expense",function(a,b,c){return a.expenses=c.query({tripId:a.trip.id})}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("InviteCtrl",["$scope","$routeParams","Trip","$http","domain",function(a,b,c,d,e){return a.tripId=b.tripId,a.fetchingFriends=!0,a.trip=c.get({id:b.tripId}),d.get(""+e+"/twitter_friends").success(function(b){return a.twitterFriends=b,a.fetchingFriends=!1}),a.invite=function(b){return a.twitterFriends[b].invited=!0,d.post(""+e+"/twitter_friends/invite",{name:a.twitterFriends[b].name,twitter_id:a.twitterFriends[b].id,trip_id:a.tripId})}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("JoinCtrl",["$scope","$cookieStore","$routeParams","$location",function(a,b,c,d){return b.put("UserId",c.userId),d.path("/")}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("MemberCtrl",["$scope","$routeParams","Member","Trip","$location",function(a,b,c,d,e){return a.trip=d.get({id:b.tripId}),a.member=c.get({tripId:b.tripId,id:b.id},function(){return a.setTitle(a.member.name)}),a.isMe=function(b){return b.id===a.currentUser.id},a.hasPurchases=function(){return a.member&&a.member.purchases&&0!==a.member.purchases.length},a.hasObligations=function(){return a.member&&a.member.obligations&&0!==a.member.obligations.length},a.hasContributions=function(){return a.member&&a.member.contributions&&0!==a.member.contributions.length},a["delete"]=function(){return confirm("Are you sure you want to delete "+a.member.name+"?")?a.trip.removeMember(a.member).success(function(){return console.log("here"),a.isMe(a.member)?e.path("/profile"):e.path("/trips/"+a.trip.id+"/members")}):void 0}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("MemberFormCtrl",["$scope","$location","$routeParams","User",function(a,b,c,d){return a.tripId=c.tripId,a.member=d.get({id:c.id}),a.update=function(){return a.member.$update(function(){return b.path("/trips/"+a.tripId+"/members/"+a.member.id)})}}])}.call(this),function(){angular.module("groupExpenserClientApp").controller("MembersCtrl",["$scope","$routeParams","Member","Trip",function(a,b,c,d){return a.tripId=b.tripId,a.trip=d.get({id:b.tripId}),a.members=c.query({tripId:b.tripId})}])}.call(this);